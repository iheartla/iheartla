<html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
            <script>
        MathJax = {
          loader: {
            load: ["[attrLabel]/attr-label.js"],
            paths: { attrLabel: "../heartdown-resource" },
          },
          tex: { packages: { "[+]": ["attr-label"] },
           inlineMath: [['$', '$']]
           },
           options: {
            enableAssistiveMml: false
          },
        };
            </script>
            <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script src="https://unpkg.com/@popperjs/core@2"></script>
            <script src="https://unpkg.com/tippy.js@6"></script>
            <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/svg-arrow.css"/>
            <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/border.css" />
            <script src="../heartdown-resource/d3.min.js"></script>
            <script src="../heartdown-resource/svg.min.js"></script>
            <script type="text/javascript" src='../heartdown-resource/paper.js'></script>
            <link rel="stylesheet" href="../heartdown-resource/paper.css">
        </head>
        <script>
        const iheartla_data = JSON.parse('{"equations":[{"name":"siere", "parameters":[{"sym":"$U_s$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"s"}},{"sym":"M", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}},{"sym":"v", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"f", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"K", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}},{"sym":"$\\\\boldsymbol{I}$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}},{"sym":"h", "type_info":{"type": "scalar", "is_int":"False"}},{"sym":"$φ_1$", "type_info":{"type": "function", "params":[{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"k", "cols":"k"}], "ret":[{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"k", "cols":"k"}]}},{"sym":"u", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}}], "definition":[{"sym":"$G(u)$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}},{"sym":"$H(u)$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}},{"sym":"$v_G$", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"$v_H$", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"$f_G$", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"$f_H$", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}},{"sym":"$J_G$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}},{"sym":"$J_H$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}},{"sym":"$u_+$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}},{"sym":"$J_G^r$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*s", "cols":"2*s"}},{"sym":"$G^r(u)$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*s", "cols":"1"}}], "local_func":[], "dependence":[], "undesc_list":["K","$u_+$","f","$G(u)$","$J_G^r$","v","$J_G$","u","$G^r(u)$","$H(u)$","$v_G$","$φ_1$","$\\\\boldsymbol{I}$","$J_H$","$U_s$","$v_H$","M","$f_H$","h","$f_G$"] },{"name":"second", "parameters":[{"sym":"$U_s$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"s"}},{"sym":"M", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}},{"sym":"K", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}}], "definition":[{"sym":"$J_G$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"n + 1"}},{"sym":"$Y_1$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}},{"sym":"$Z_1$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}},{"sym":"$Y_2$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}},{"sym":"$Z_2$", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}}], "local_func":[], "dependence":[], "undesc_list":["$Z_2$","K","$U_s$","M","$J_G$","$Z_1$","$Y_1$","$Y_2$"] }], "context":["siere","second"] }');
        const sym_data = JSON.parse('{"$U_s$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"s"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color1"},{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"s"}, "def_module":"second", "is_defined":false, "used_equations":[], "color":"color1"}],"M":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color2"},{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}, "def_module":"second", "is_defined":false, "used_equations":[], "color":"color2"}],"v":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color7"}],"f":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color10"}],"K":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color8"},{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n", "cols":"n"}, "def_module":"second", "is_defined":false, "used_equations":[], "color":"color8"}],"$\\\\boldsymbol{I}$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color8"}],"h":[{"desc":"None", "type_info":{"type": "scalar", "is_int":"False"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color10"}],"$φ_1$":[{"desc":"None", "type_info":{"type": "function", "params":[{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"k", "cols":"k"}], "ret":[{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"k", "cols":"k"}]}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color9"}],"u":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}, "def_module":"siere", "is_defined":false, "used_equations":[], "color":"color6"}],"$G(u)$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color5"}],"$H(u)$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color3"}],"$v_G$":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color3"}],"$v_H$":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color4"}],"$f_G$":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color9"}],"$f_H$":[{"desc":"None", "type_info":{"type": "vector", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color1"}],"$J_G$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color3"},{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"n + 1"}, "def_module":"second", "is_defined":true, "used_equations":[], "color":"color3"}],"$J_H$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"2*n"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color4"}],"$u_+$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*n", "cols":"1"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color7"}],"$J_G^r$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*s", "cols":"2*s"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color2"}],"$G^r(u)$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"2*s", "cols":"1"}, "def_module":"siere", "is_defined":true, "used_equations":[], "color":"color5"}],"$Y_1$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}, "def_module":"second", "is_defined":true, "used_equations":[], "color":"color2"}],"$Z_1$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}, "def_module":"second", "is_defined":true, "used_equations":[], "color":"color6"}],"$Y_2$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}, "def_module":"second", "is_defined":true, "used_equations":[], "color":"color5"}],"$Z_2$":[{"desc":"None", "type_info":{"type": "matrix", "is_int":"False", "element":{"type": "scalar", "is_int":"False"}, "rows":"n + 1", "cols":"s"}, "def_module":"second", "is_defined":true, "used_equations":[], "color":"color4"}]}');
        window.onload = onLoad;
        function reportWindowSize() {
          var arrows = document.querySelectorAll(".arrow");
          if (arrows) {
            for (var i = arrows.length - 1; i >= 0; i--) {
              var arrow = arrows[i];
              var body = document.querySelector("body");
              var style = window.getComputedStyle(body);
              var arrowPanel = document.querySelector("#arrows");
              var arrowRect = arrowPanel.getBoundingClientRect();
              var curOffset = parseInt(style.marginLeft, 10)
              var oldOffset = arrow.getAttribute('offset');
              curOffset += arrowRect.width;
              arrow.setAttribute('offset', curOffset);
              // console.log(`oldOffset:${oldOffset}, curOffset:${curOffset}`);
              var arrowStyle = window.getComputedStyle(arrow); 
              var arrowOffset = parseInt(document.querySelector(".arrow").style.marginLeft, 10)
              arrow.style.marginLeft = `${arrowOffset+curOffset-oldOffset}px`;
              var newWidth = parseInt(style.width, 10) + parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);
              arrow.style.width = `${newWidth}px`;
              arrow.style.height = style.height; 
              // console.log(`arrow.style.width:${arrow.style.width}, arrow.style.height:${arrow.style.height}`)
            }
          }
          adjustGlossaryBtn();
        }
        window.onresize = reportWindowSize;
        document.addEventListener("click", function(evt){
            onClickPage();
        });
        
        </script>
<body>
    <div id="flexer">
        <div id="arrows"></div>
        <div id="main">
        <div class='title'>SIERE a hybrid semi-implicit exponential integrator for efficiently simulating stiff deformable objects</div><div class='author'>YU JU (EDWIN) CHEN, University of British Columbia</div><div class='author'>SEUNG HEON SHEEN, University of British Columbia</div><div class='author'>URI M. ASCHER, University of British Columbia</div><div class='author'>DINESH K. PAI, University of British Columbia and Vital Mechanics Research</div><div class='context' id='context-siere-0' context='siere'>
<h1 id='method'>3&nbsp;METHOD</h1><h2 id='model-reduction-and-subspace-splitting'>3.1&nbsp;Model reduction and subspace splitting</h2><p>Next, we define the splitting $G$ and $H$, crucial to the success of our method. The idea is to apply ERE in the subspace of the first s modes ($s ≪ n$: typically, $5 ≤ s ≤ 20$) and project it back to the original full space. In the bridge example of Figure 1, $n ≈ 100, 000$, so this is a rather large reduction.</p>
<p>Then we use SI on the remaining unevaluated part, as per Eq. (5). We use mass-PCA to find our reduced space. That is, considering at the beginning of each time step a solution mode of the form $q(t) = w exp(ı\sqrt{λ}t)$ for the ODE ${\proselabel{siere}{{M}}} q  + {\proselabel{siere}{{K}}} q = 0$, we solve the generalized eigenvalue problem</p>
<p>$$ {\proselabel{siere}{{K}}} w = λ {\proselabel{siere}{{M}}} w 
\notag$$</p>
<p>for the $s$ smallest eigenvalues $λ$ and their corresponding eigenvectors $w$ (dominant modes). In Matlab, for instance, this can be achieved by calling the function eigs. In our implementation, we use the C++ Spectra library [Qiu 2019]. Denote this partial spectral decomposition by</p>
<p>$${\proselabel{siere}{{K}}} {\proselabel{siere}{{U_s}}} ={\proselabel{siere}{{M}}} {\proselabel{siere}{{U_s}}} Λ_s\tag{6}\label{6}$$</p>
<p>where the “long and skinny” ${\proselabel{siere}{{U_s}}}$ is $n × s$, has the first s eigenvectors $w$ as its columns, and the small $Λ_s$ is a diagonal $s × s$ matrix with the eigenvalues $λ_1, ..., λ_s$ on the diagonal. Notice that both ${\proselabel{siere}{{K}}}$ and ${\proselabel{siere}{{M}}}$ are large sparse symmetric matrices. In addition, ${\proselabel{siere}{{M}}}$ is positive definite, so ${\proselabel{siere}{{U_s}}}$ has M-orthogonal columns:</p>
<p>$${\proselabel{siere}{{U_s}}} ^T {\proselabel{siere}{{M}}} {\proselabel{siere}{{U_s}}} = I_s, {\proselabel{siere}{{U_s}}} ^T {\proselabel{siere}{{K}}} {\proselabel{siere}{{U_s}}} = Λ_s. \tag{7}\label{7}$$</p>
<p>Next, we write Eq. (2) in the split form Eq. (3), with the splitting $H$ and $G$ defined based on the partial spectral decomposition Eq. (6). We define at each time step</p>
<p>
        <div class='equation' code_block="siere" code="YCRHKHUpJGAgPSBbYCR2X0ckYAogICAgICAgICAgTeKBu8K5YCRmX0ckYF0KYCRIKHUpJGAgPSBbYCR2X0gkYAogICAgICAgICAgTeKBu8K5YCRmX0gkYF0KYCR2X0ckYCA9IGAkVV9zJGBgJFVfcyRgXlQgTXYKYCR2X0gkYCA9ICB2IC0gYCR2X0ckYApgJGZfRyRgID0gIE1gJFVfcyRgYCRVX3MkYF5UIGYKYCRmX0gkYCA9ICBmIC0gYCRmX0ckYAoKd2hlcmUgCmAkVV9zJGAgOiDihJ1eKG4gw5cgcykKTSA6IOKEnV4obiDDlyBuKQp2IDog4oSdXm4KZiA6IOKEnV5uCksgOiDihJ1eKG4gw5cgbik=">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$G(u)$', 'siere', 'def', false, '')", "id":"siere-$G(u)$", "sym":"$G(u)$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {G(u)} } & = \begin{bmatrix}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$v_G$', 'siere', 'use', false, '')", "id":"siere-$v_G$", "sym":"$v_G$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {v_G} }\\
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }^{-1}\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$f_G$', 'siere', 'use', false, '')", "id":"siere-$f_G$", "sym":"$f_G$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {f_G} }\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$f_G$', '$v_G$', 'M', '$G(u)$'], false, [], [], 'YCRHKHUpJGAgPSBbYCR2X0ckYAogICAgICAgICAgTeKBu8K5YCRmX0ckYF0=');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$H(u)$', 'siere', 'def', false, '')", "id":"siere-$H(u)$", "sym":"$H(u)$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {H(u)} } & = \begin{bmatrix}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$v_H$', 'siere', 'use', false, '')", "id":"siere-$v_H$", "sym":"$v_H$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {v_H} }\\
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }^{-1}\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$f_H$', 'siere', 'use', false, '')", "id":"siere-$f_H$", "sym":"$f_H$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {f_H} }\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$f_H$', '$v_H$', 'M', '$H(u)$'], false, [], [], 'YCRIKHUpJGAgPSBbYCR2X0gkYAogICAgICAgICAgTeKBu8K5YCRmX0gkYF0=');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$v_G$', 'siere', 'def', false, '')", "id":"siere-$v_G$", "sym":"$v_G$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {v_G} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'v', 'siere', 'use', false, '')", "id":"siere-v", "sym":"v", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{v}} }\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['v', '$U_s$', 'M', '$v_G$'], false, [], [], 'YCR2X0ckYCA9IGAkVV9zJGBgJFVfcyRgXlQgTXY=');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$v_H$', 'siere', 'def', false, '')", "id":"siere-$v_H$", "sym":"$v_H$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {v_H} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'v', 'siere', 'use', false, '')", "id":"siere-v", "sym":"v", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{v}} } - \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$v_G$', 'siere', 'use', false, '')", "id":"siere-$v_G$", "sym":"$v_G$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {v_G} }\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$v_G$', 'v', '$v_H$'], false, [], [], 'YCR2X0gkYCA9ICB2IC0gYCR2X0ckYA==');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$f_G$', 'siere', 'def', false, '')", "id":"siere-$f_G$", "sym":"$f_G$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {f_G} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'f', 'siere', 'use', false, '')", "id":"siere-f", "sym":"f", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{f}} }\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['f', '$U_s$', 'M', '$f_G$'], false, [], [], 'YCRmX0ckYCA9ICBNYCRVX3MkYGAkVV9zJGBeVCBm');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$f_H$', 'siere', 'def', false, '')", "id":"siere-$f_H$", "sym":"$f_H$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {f_H} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'f', 'siere', 'use', false, '')", "id":"siere-f", "sym":"f", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{f}} } - \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$f_G$', 'siere', 'use', false, '')", "id":"siere-$f_G$", "sym":"$f_G$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {f_G} }\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$f_G$', 'f', '$f_H$'], false, [], [], 'YCRmX0gkYCA9ICBmIC0gYCRmX0ckYA==');"} }{}
\end{align*}
\tag{8}\label{8}$$</div>
        </p>
<p>We also need the Jacobian matrices</p>
<p>
        <div class='equation' code_block="siere" code="YCRKX0ckYCA9IFswICAgIGAkVV9zJGBgJFVfcyRgXlRNCiAgICAgIC1gJFVfcyRgYCRVX3MkYF5US2AkVV9zJGBgJFVfcyRgXlRNIDAgXQpgJEpfSCRgID0gIFswICAgICBJX24KICAgICAgICAgICAgLU3igbvCuUsgMF0gLSBgJEpfRyRgIAo=">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_G$', 'siere', 'def', false, '')", "id":"siere-$J_G$", "sym":"$J_G$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {J_G} } & = \begin{bmatrix}
0 & \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\\
-\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'K', 'siere', 'use', false, '')", "id":"siere-K", "sym":"K", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{K}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} } & 0\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$U_s$', 'M', 'K', '$J_G$'], false, [], [], 'YCRKX0ckYCA9IFswICAgIGAkVV9zJGBgJFVfcyRgXlRNCiAgICAgIC1gJFVfcyRgYCRVX3MkYF5US2AkVV9zJGBgJFVfcyRgXlRNIDAgXQ==');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_H$', 'siere', 'def', false, '')", "id":"siere-$J_H$", "sym":"$J_H$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {J_H} } & = \begin{bmatrix}
0 & I_{ \mathit{n} }\\
-\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }^{-1}\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'K', 'siere', 'use', false, '')", "id":"siere-K", "sym":"K", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{K}} } & 0\\
\end{bmatrix} - \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_G$', 'siere', 'use', false, '')", "id":"siere-$J_G$", "sym":"$J_G$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {J_G} }\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$J_G$', 'M', 'K', '$J_H$'], false, [], [], 'YCRKX0gkYCA9ICBbMCAgICAgSV9uCiAgICAgICAgICAgIC1N4oG7wrlLIDBdIC0gYCRKX0ckYA==');"} }{}
\end{align*}
\tag{9}\label{9}$$</div>
        </p>
<p>Notice that the ERE expression, ${\proselabel{siere}{{h}}} {\proselabel{siere}{{φ_1}}} ( {\proselabel{siere}{{h}}} {\proselabel{siere}{{J_G}}} ) {\proselabel{siere}{{G(u)}}} $, can be evaluated in the subspace first, and then projected back to the original space.</p>
<p>The additive method defined by inserting Eqs. (8) and (9) into Eq.(5) has three advantages:</p>
<ul>
<li>(1) At each time step, the majority of the update comes from ERE in the dominating modes. Thus it is less affected by artificial damping from SI.</li>
<li>(2) The computation load of ERE is greatly reduced, because the stiff part is handled by SI (or BE for that matter). Furthermore, the evaluation of the exponential function in the subspace has only marginal cost since the crucial matrix involved has been diagonalized.</li>
<li>(3) The “warm start” for SI makes its result closer to that of BE.</li>
</ul>
<p>ERE update in the subspace: To evaluate the update in the subspace of dimension s we rewrite Eq. (5) as</p>
<p>
        <div class='equation' code_block="siere" code="YCR1XyskYCA9ICB1ICsgKGAkXGJvbGRzeW1ib2x7SX0kYCAtaGAkSl9IJGAp4oG7wrkoaCBgJEgodSkkYCArIGhbYCRVX3MkYCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCAgIGAkVV9zJGBdIGAkz4ZfMSRgKGhgJEpfR15yJGApIGAkR15yKHUpJGApCndoZXJlIApgJFxib2xkc3ltYm9se0l9JGAgOiDihJ1eKDJuIMOXIDJuKQpoIDog4oSdCmAkz4ZfMSRgIDog4oSdXihrw5drKSAtPiDihJ1eKGvDl2spCnUgOiDihJ1eKDJuIMOXIDEp">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$u_+$', 'siere', 'def', false, '')", "id":"siere-$u_+$", "sym":"$u_+$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {u_+} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'u', 'siere', 'use', false, '')", "id":"siere-u", "sym":"u", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{u}} } + \left( \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$\\\\boldsymbol{I}$', 'siere', 'use', false, '')", "id":"siere-$\\\\boldsymbol{I}$", "sym":"$\\\\boldsymbol{I}$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\boldsymbol{I}} } - \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'h', 'siere', 'use', false, '')", "id":"siere-h", "sym":"h", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{h}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_H$', 'siere', 'use', false, '')", "id":"siere-$J_H$", "sym":"$J_H$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {J_H} } \right)^{-1}\left( \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'h', 'siere', 'use', false, '')", "id":"siere-h", "sym":"h", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{h}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$H(u)$', 'siere', 'use', false, '')", "id":"siere-$H(u)$", "sym":"$H(u)$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {H(u)} } + \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'h', 'siere', 'use', false, '')", "id":"siere-h", "sym":"h", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{h}} }\begin{bmatrix}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} } & 0\\
0 & \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }\\
\end{bmatrix}\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$φ_1$', 'siere', 'use', false, '')", "id":"siere-$φ_1$", "sym":"$φ_1$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {φ_1} }\left( \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'h', 'siere', 'use', false, '')", "id":"siere-h", "sym":"h", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{h}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_G^r$', 'siere', 'use', false, '')", "id":"siere-$J_G^r$", "sym":"$J_G^r$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {J_G^r} } \right)\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$G^r(u)$', 'siere', 'use', false, '')", "id":"siere-$G^r(u)$", "sym":"$G^r(u)$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {G^r(u)} } \right)\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$J_G^r$', '$φ_1$', '$\\\\boldsymbol{I}$', '$J_H$', '$U_s$', '$H(u)$', '$G^r(u)$', 'h', 'u', '$u_+$'], false, [], [], 'YCR1XyskYCA9ICB1ICsgKGAkXGJvbGRzeW1ib2x7SX0kYCAtaGAkSl9IJGAp4oG7wrkoaCBgJEgodSkkYCArIGhbYCRVX3MkYCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCAgIGAkVV9zJGBdIGAkz4ZfMSRgKGhgJEpfR15yJGApIGAkR15yKHUpJGAp');"} }{}
\end{align*}
\tag{10}\label{10}$$</div>
        </p>
<p>where<br />

        <div class='equation' code_block="siere" code="YCRKX0deciRgID0gWzAgICAgIElfcwogICAgICAgICAgICAtYCRVX3MkYF5US2AkVV9zJGAgMF0KYCRHXnIodSkkYCA9IFtgJFVfcyRgXlRNdgogICAgICAgICAgICBgJFVfcyRgXlRmXQo=">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_G^r$', 'siere', 'def', false, '')", "id":"siere-$J_G^r$", "sym":"$J_G^r$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {J_G^r} } & = \begin{bmatrix}
0 & I_{ \mathit{s} }\\
-{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'K', 'siere', 'use', false, '')", "id":"siere-K", "sym":"K", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{K}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} } & 0\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['$U_s$', 'K', '$J_G^r$'], false, [], [], 'YCRKX0deciRgID0gWzAgICAgIElfcwogICAgICAgICAgICAtYCRVX3MkYF5US2AkVV9zJGAgMF0=');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$G^r(u)$', 'siere', 'def', false, '')", "id":"siere-$G^r(u)$", "sym":"$G^r(u)$", "func":"siere",  "localFunc":"", "type":"def", "case":"equation"} }{ {G^r(u)} } & = \begin{bmatrix}
{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'siere', 'use', false, '')", "id":"siere-M", "sym":"M", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'v', 'siere', 'use', false, '')", "id":"siere-v", "sym":"v", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{v}} }\\
{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'siere', 'use', false, '')", "id":"siere-$U_s$", "sym":"$U_s$", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'f', 'siere', 'use', false, '')", "id":"siere-f", "sym":"f", "func":"siere",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{f}} }\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'siere', ['v', 'f', '$U_s$', 'M', '$G^r(u)$'], false, [], [], 'YCRHXnIodSkkYCA9IFtgJFVfcyRgXlRNdgogICAgICAgICAgICBgJFVfcyRgXlRmXQ==');"} }{}
\end{align*}
\tag{11}\label{11}$$</div>
        </p>
<p>The evaluation of the action of the matrix function ${\proselabel{siere}{{φ_1}}}$ involves only matrices of size $2s × 2s$. Furthermore, the matrix function ${\proselabel{siere}{{φ_1}}}$ can be evaluated directly through the eigenpairs of ${\proselabel{siere}{{J_G^r}}}$<br />
 $$ 
\Bigg\{ ı\sqrt{λ_l}, \begin{bmatrix} e_l \\ ı\sqrt{λ_l}e_l  \end{bmatrix}  \Bigg\} , 
\Bigg\{ -ı\sqrt{λ_l}, \begin{bmatrix} -e_l \\ ı\sqrt{λ_l}e_l  \end{bmatrix}  \Bigg\},
l = 1,...,s,
 \tag{12}\label{12}$$</p>
<p>with $e_l$ being the $l^{th}$ column of the identity matrix.</p>
<p>The large $n×n$ linear system solved in Eq. (10) is not sparse due to the fill-in introduced by the small subspace projection. Specifically, the off-diagonal blocks of the Jacobian matrix ${\proselabel{siere}{{J_G}}}$ defined in Eq. (9a) are not sparse. If not treated carefully, solving the linear system in Eq. (5) and Eq. (10) can be prohibitively costly. Fortunately, this modification matrix has the low rank $s$. We can write</p>
</div><div class='context' id='context-second-0' context='second'>
<p>
        <div class='equation' code_block="second" code="YCRKX0ckYCA9IGAkWV8xJGBgJFpfMSRgXlQgKyBgJFlfMiRgYCRaXzIkYF5UIA==">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$J_G$', 'second', 'def', false, '')", "id":"second-$J_G$", "sym":"$J_G$", "func":"second",  "localFunc":"", "type":"def", "case":"equation"} }{ {J_G} } & = \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Y_1$', 'second', 'use', false, '')", "id":"second-$Y_1$", "sym":"$Y_1$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {Y_1} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Z_1$', 'second', 'use', false, '')", "id":"second-$Z_1$", "sym":"$Z_1$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {Z_1} }}^T + \idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Y_2$', 'second', 'use', false, '')", "id":"second-$Y_2$", "sym":"$Y_2$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {Y_2} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Z_2$', 'second', 'use', false, '')", "id":"second-$Z_2$", "sym":"$Z_2$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {Z_2} }}^T\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'second', ['$Y_2$', '$Y_1$', '$Z_1$', '$Z_2$', '$J_G$'], false, [], [], 'YCRKX0ckYCA9IGAkWV8xJGBgJFpfMSRgXlQgKyBgJFlfMiRgYCRaXzIkYF5U');"} }{}
\end{align*}
\notag$$</div>
        </p>
<p>where <br />

        <div class='equation' code_block="second" code="YCRZXzEkYCA9ICBbYCRVX3MkYAogICAgICAgICAgICAgMF0KYCRaXzEkYCA9ICBbIDAKICAgICAgICAgICAgIE1gJFVfcyRgXSAKYCRZXzIkYCA9ICBbMAogICAgICAgICAgICAtYCRVX3MkYGAkVV9zJGBeVEtgJFVfcyRgXQpgJFpfMiRgID0gIFsgTWAkVV9zJGAKICAgICAgICAgICAgIDBdIAoKd2hlcmUgCmAkVV9zJGAgOiDihJ1eKG4gw5cgcykKTSA6IOKEnV4obiDDlyBuKSAKSyA6IOKEnV4obiDDlyBuKQ==">
        $$\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\begin{align*}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Y_1$', 'second', 'def', false, '')", "id":"second-$Y_1$", "sym":"$Y_1$", "func":"second",  "localFunc":"", "type":"def", "case":"equation"} }{ {Y_1} } & = \begin{bmatrix}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }\\
0\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'second', ['$U_s$', '$Y_1$'], false, [], [], 'YCRZXzEkYCA9ICBbYCRVX3MkYAogICAgICAgICAgICAgMF0=');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Z_1$', 'second', 'def', false, '')", "id":"second-$Z_1$", "sym":"$Z_1$", "func":"second",  "localFunc":"", "type":"def", "case":"equation"} }{ {Z_1} } & = \begin{bmatrix}
0\\
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'second', 'use', false, '')", "id":"second-M", "sym":"M", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'second', ['$U_s$', 'M', '$Z_1$'], false, [], [], 'YCRaXzEkYCA9ICBbIDAKICAgICAgICAgICAgIE1gJFVfcyRgXQ==');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Y_2$', 'second', 'def', false, '')", "id":"second-$Y_2$", "sym":"$Y_2$", "func":"second",  "localFunc":"", "type":"def", "case":"equation"} }{ {Y_2} } & = \begin{bmatrix}
0\\
-\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }{\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }}^T\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'K', 'second', 'use', false, '')", "id":"second-K", "sym":"K", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{K}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'second', ['$U_s$', 'K', '$Y_2$'], false, [], [], 'YCRZXzIkYCA9ICBbMAogICAgICAgICAgICAtYCRVX3MkYGAkVV9zJGBeVEtgJFVfcyRgXQ==');"} }{}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$Z_2$', 'second', 'def', false, '')", "id":"second-$Z_2$", "sym":"$Z_2$", "func":"second",  "localFunc":"", "type":"def", "case":"equation"} }{ {Z_2} } & = \begin{bmatrix}
\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, 'M', 'second', 'use', false, '')", "id":"second-M", "sym":"M", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {\mathit{M}} }\idlabel{ {"onclick":"event.stopPropagation(); onClickSymbol(this, '$U_s$', 'second', 'use', false, '')", "id":"second-$U_s$", "sym":"$U_s$", "func":"second",  "localFunc":"", "type":"use", "case":"equation"} }{ {U_s} }\\
0\\
\end{bmatrix}\\\eqlabel{ {"onclick":"event.stopPropagation(); onClickEq(this, 'second', ['$U_s$', 'M', '$Z_2$'], false, [], [], 'YCRaXzIkYCA9ICBbIE1gJFVfcyRgCiAgICAgICAgICAgICAwXQ==');"} }{}
\end{align*}
\notag$$</div>
        </p>
<p>The linear system in Eq. (10) becomes</p>
<p>$$ I−h J_H =(I−h J)+h {\proselabel{second}{{Y_1}}} {\proselabel{second}{{Z_1}}} ^T +h {\proselabel{second}{{Y_2}}} {\proselabel{second}{{Z_2}}} ^T \tag{13}\label{13}$$</p>
<p>where the four matrices $Y_i$ and $Z_i$ are all “long and skinny” like ${\proselabel{second}{{U_s}}}$, while the matrix $J$ is square and large, but very sparse. Figure 3 illustrates this situation. For the linear system to be solved in Eq. (10) we may employ an iterative method such as conjugate gradient, whereby the matrix-vector products involving $J$ or $Y_iZ_i^T$ are all straightforward to carry out efficiently. However, we have often found out that a direct solution method is more appropriate for these linear equations in our context. In our implementation we use pardiso [De Coninck et al. 2016; Kourounis et al. 2018; Verbosio et al. 2017]. For this we can employ the formula of Sherman, Morrison and Woodbury (SMW) [Nocedal and Wright 2006], given by</p>
<figure>
<img src="./img/img3.png" alt="Trulli" style="width:100%" class = "center">
<figcaption align = "center">Fig. 3. The matrix $I − h J_H$ in the linear system eq. (10) is not sparse (c). Fortunately, by Eq. (13) the fill-in to the original sparse matrix $I − h J (a)$ has low rank (b) allowing us to use the SMW formula $E_q$. (14).
</figcaption> 
</figure>
<p>$$ (A+YZ^T)^{−1} =A^{−1}−A^{−1}Y(I +Z^TA^{−1}Y)^{−1}Z^TA^{−1} \tag{14}\label{14}$$</p>
<p>to solve the linear system in Eq. (10). In our specific notation we set at each time step $A = I − h J_H$ in Eq. (14), and apply the formula twice:once for $Y = {\proselabel{second}{{Y_1}}}$, $Z = {\proselabel{second}{{Z_1}}}$, and once for $Y = {\proselabel{second}{{Y_2}}}$, $Z = {\proselabel{second}{{Z_2}}}$. Note that the matrices $I + Z^T A^{−1}Y$ in Eq. (14) are only $2s × 2s$, and this results in an efficient implementation, so long as the subspace dimension s remains small.</p>
<div class="references"></div></div>
        </div>
        <div id="glossary_holder"><div id="glossary" class="glossary"></div></div>
    </div>
</body>
</html>